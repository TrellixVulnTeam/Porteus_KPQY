#!/bin/bash
#
# rc.4		This file is executed by init(8) when the system is being
#		initialized for run level 4.

# Run X11 startup helper:
pidof watch-xorg >/dev/null && sleep 4 || /opt/porteus-scripts/xorg/watch-xorg 2>/dev/null &

# Start KDE desktop:
login=`egrep -o " login=[^ ]+*" /proc/cmdline | cut -d= -f2`
nologin=`grep -o nologin /proc/cmdline`
[ "$login" ] && sed -i 's/^.*User=.*/User='$login'/g' /etc/sddm.conf
[ "$nologin" ] && sed -i 's/^User=.*/#User=/g' /etc/sddm.conf
/usr/bin/sddm
