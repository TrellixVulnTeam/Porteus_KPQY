#!/bin/env python3

## A simple read-only text viewer
## Author: jssouza

import gi
gi.require_version('Gtk', '3.0')
from gi.repository import Gtk
import argparse
import os

class PView(Gtk.Window):

    def __init__(self):
        self.contents = ""
        self.height = 550
        self.width = 500
        self.header = "PView"
        parser = argparse.ArgumentParser()
        parser.add_argument("-f", "--file", help = "Path of filename to display")
        parser.add_argument("-w", "--width", help = "Window breadth (width)", type=int)        
        parser.add_argument("-l", "--length", help = "Window length (height)", type=int)
        args = parser.parse_args()
        if args.file:
            self.header = args.file
            if os.path.exists(args.file):            
                with open(args.file, mode = "r", encoding = "utf-8") as fd: 
                    self.contents = fd.read()

        if args.length:
            self.height = args.length
            
        if args.width:
            self.width = args.width

        Gtk.Window.__init__(self, title = self.header, border_width = 5, height_request = self.height, width_request = self.width, icon_name = "accessories-ebook-reader")

        self.create_textview()

    def create_textview(self):
        scrolledwindow = Gtk.ScrolledWindow()
        scrolledwindow.set_hexpand(True)
        scrolledwindow.set_vexpand(True)
        self.add(scrolledwindow)

        self.textview = Gtk.TextView(border_width = 16)
        self.textbuffer = self.textview.get_buffer()
        self.textbuffer.set_text(self.contents)
        self.textview.set_editable(False)
        self.textview.set_wrap_mode(True)

        scrolledwindow.add(self.textview)

win = PView()
win.connect("destroy", Gtk.main_quit)
win.show_all()
Gtk.main()

