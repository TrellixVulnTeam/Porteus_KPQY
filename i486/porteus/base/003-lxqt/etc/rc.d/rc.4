#!/bin/bash
#
# rc.4		This file is executed by init(8) when the system is being
#		initialized for run level 4.

# Run X11 startup helper:
pidof watch-xorg >/dev/null && sleep 4 || /opt/porteus-scripts/xorg/watch-xorg 2>/dev/null &

# Start desktop:
login=`egrep -o " login=[^ ]+*" /proc/cmdline | cut -d= -f2`
[ "$login" ] && sed -i -r "s/^default_user.*$/default_user $login/g" /etc/slim.conf || sed -i -r "s/^default_user.*$/default_user guest/g" /etc/slim.conf
/usr/bin/slim >/dev/null 2>&1
